%% inputs

% pointLog = [30.51639250256 114.3491630599 3.212;
%     30.51642104432 114.34916453550 0.1268;
%     30.51645149053 114.34916427738 358.650;
%     30.51648437408 114.34916349469 1.5224;
%     30.51652058824 114.34916741007 6.9508;
%     30.51654542261 114.34917132795 8.150;
%     30.51657104079 114.34917598108 10.773;
%     30.51660913178 114.34918715581 13.842;
%     30.51663462019 114.34919647087 13.796;
%     30.51668759395 114.34921194841 14.557;
%     30.51671386579 114.34922111149 15.091;
%     30.51673874412 114.34922971296 15.107;
%     30.51677680957 114.34924020639 16.390;
%     30.51680287605 114.34924929806 16.718;
%     30.51682956300 114.34925857953 16.728;
%     30.51685777127 114.34926772820 16.319;
%     30.51687249915 114.34927270679 15.754;
%     30.51690256789 114.34928405332 15.746;
%     30.51693260201 114.34929388083 15.162;
%     30.51697967905 114.34930856761 13.714;
%     30.51701170385 114.34931773747 14.103;
%     30.51704483462 114.34932777333 14.190;
%     30.51706109122 114.34933255432 13.858;
%     30.51709384225 114.34934198688 13.323;
%     30.51711096556 114.34934685829 13.758;
%     30.51716175347 114.34936282278 17.946;
%     30.51717716803 114.34936876667 20.102;
%     30.51719156064 114.34937505659 22.288;
%     30.51723099812 114.34939560656 26.676;
%     30.51726802895 114.34941696151 26.647;
%     30.51729260317 114.34943100505 23.675;
%     30.51731813238 114.34944347616 18.465;
%     30.51736056199 114.34945854741 13.891;
%     30.51738755395 114.34946661504 12.372;
%     30.51740084014 114.34947024046 10.842;
%     30.51742909941 114.34947672934 8.857;
%     30.51744395795 114.34947967758 7.768;
%     30.51747163526 114.34948431501 5.682;
%     30.51748507211 114.34948606346 4.580;
%     30.51751332043 114.34948885207 3.778;
%     30.51754278910 114.34949119623 3.102;
%     30.51755681844 114.34949232977 3.113;
%     30.51758455863 114.34949446931 3.159;
%     30.51761321461 114.34949653320 2.645;
%     30.51762755334 114.34949744814 2.223;
%     30.51765490202 114.34949905760 2.537;
%     30.51769453519 114.34950140217 3.857;]; % 20200921南门RTK实录

load('pointN2SLog');
% pointLog = [logIn.lat logIn.lon logIn.azimuth];



% 南门到坡的轨迹
for i = 1:1:length(pointLog(:,3))
    if pointLog(i,3)>=180
        pointLog(i,3) = pointLog(i,3)-360;
    end
end

ii = 1;
for i = 1:2:length(pointLog(:,3))
    pointInS2N(ii,1) = pointLog(i,1);
    pointInS2N(ii,2) = pointLog(i,2);
    pointInS2N(ii,3) = pointLog(i,3);
    ii = ii+1;
end

% 坡道南门的轨迹
pointInN2S = flipud(pointInS2N);
for i = 1:1:length(pointInN2S(:,1))
   if pointInN2S(i,3)>0
       pointInN2S(i,3) = pointInN2S(i,3)-180;
   else
       pointInN2S(i,3) = pointInN2S(i,3)+180;
   end
end


% vehLo = [30.51677680957 114.34924020639 15.329813129000000];


%% 使用三次样条扩充参考轨迹点，对参考线进行初始化
oriPoint = [30.51552 114.34458]; % 全局XY坐标的原点
pointNum = 30;


[distXYS2N(:,1), distXYS2N(:,2)] = latlon2global(oriPoint,pointInS2N);
[distXYN2S(:,1), distXYN2S(:,2)] = latlon2global(oriPoint,pointInN2S);

% roadInfo.centreRefLine = [zeros(pointNum,1) zeros(pointNum,1) zeros(pointNum,1)];
% 
% roadInfo.centreRefLine(:,1) = linspace(min(distXY(:,1)),max(distXY(:,1)),pointNum);
% p2 = spline(distXY(:,1),distXY(:,2));
% roadInfo.centreRefLine(:,2) = ppval(p2,roadInfo.centreRefLine(:,1));
% 
% p2 = spline(distXY(:,1),pointIn(:,3));
% roadInfo.centreRefLine(:,3) = ppval(p2,roadInfo.centreRefLine(:,1));